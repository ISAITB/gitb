<div class="root-container" (click)="$event.stopPropagation()">
    @if (hasIgnored) {
        <div class="expand-icon" (click)="expanded = true" tooltip="Expand" containerClass="shortTooltip"><span><i class="fa-solid fa-plus-circle"></i></span></div>
    }
    <div class="ratio-container">
        @if (hasRequired) {
            @if (completed > 0) {
                <div [tooltip]="completedPercentage+'% of required '+tooltipRequiredTestDescription+' are passed'" containerClass="ratioTooltip" class="ratio completed" [class.start]="true" [class.end]="failed == 0 && other == 0" [ngStyle]="{'width': completedPercentage+'%'}">{{completedPercentage}}%</div>
            }
            @if (failed > 0) {
                <div [tooltip]="failedPercentage+'% of required '+tooltipRequiredTestDescription+' are failed'" containerClass="ratioTooltip" class="ratio failed" [class.start]="completed == 0" [class.end]="other == 0" [ngStyle]="{'width': failedPercentage+'%'}">{{failedPercentage}}%</div>
            }
            @if (other > 0) {
                <div [tooltip]="otherPercentage+'% of required '+tooltipRequiredTestDescription+' are incomplete'" containerClass="ratioTooltip" class="ratio other" [class.start]="completed == 0 && failed == 0" [class.end]="true" [ngStyle]="{'width': otherPercentage+'%'}">{{otherPercentage}}%</div>
            }
        } @else {
            <div tooltip="No required test cases defined" containerClass="ratioTooltip" class="ratio other" [class.start]="true" [class.end]="true" [ngStyle]="{'width': '100%'}">100%</div>
        }
    </div>
    @if (expanded) {
        <div class="popup-panel" [class.asLine]="asLine" [class.defaultPopup]="!asLine" [class.align-right]="alignRight">
            <div class="popup-panel-container">
                <div class="ratio-root-containers">
                    <div class="ratio-root-container">
                        <div class="ratio-title">Required</div>
                        <div class="ratio-container">
                            @if (hasRequired) {
                                @if (completed > 0) {
                                    <div [tooltip]="completedPercentage+'% of required '+tooltipRequiredTestDescription+' are passed'" containerClass="ratioTooltip" class="ratio completed" [class.start]="true" [class.end]="failed == 0 && other == 0" [ngStyle]="{'width': completedPercentage+'%'}">{{completedPercentage}}%</div>
                                }
                                @if (failed > 0) {
                                    <div [tooltip]="failedPercentage+'% of required '+tooltipRequiredTestDescription+' are failed'" containerClass="ratioTooltip" class="ratio failed" [class.start]="completed == 0" [class.end]="other == 0" [ngStyle]="{'width': failedPercentage+'%'}">{{failedPercentage}}%</div>
                                }
                                @if (other > 0) {
                                    <div [tooltip]="otherPercentage+'% of required '+tooltipRequiredTestDescription+' are incomplete'" containerClass="ratioTooltip" class="ratio other" [class.start]="completed == 0 && failed == 0" [class.end]="true" [ngStyle]="{'width': otherPercentage+'%'}">{{otherPercentage}}%</div>
                                }
                            } @else {
                                <div tooltip="No required tests defined" containerClass="ratioTooltip" class="ratio other" [class.start]="true" [class.end]="true" [ngStyle]="{'width': '100%'}">100%</div>
                            }
                        </div>
                    </div>
                    @if (hasIgnored) {
                        <div class="ratio-root-container optional">
                            <div class="ratio-title optional">Ignored</div>
                            <div class="ratio-container">
                                @if (completedIgnored > 0) {
                                    <div [tooltip]="completedIgnoredPercentage+'% of ignored test cases are passed'" containerClass="ratioTooltip" class="ratio completed" [class.start]="true" [class.end]="failedIgnored == 0 && otherIgnored == 0" [ngStyle]="{'width': completedIgnoredPercentage+'%'}">{{completedIgnoredPercentage}}%</div>
                                }
                                @if (failedIgnored > 0) {
                                    <div [tooltip]="failedIgnoredPercentage+'% of ignored test cases are failed'" containerClass="ratioTooltip" class="ratio failed" [class.start]="completedIgnored == 0" [class.end]="otherIgnored == 0" [ngStyle]="{'width': failedIgnoredPercentage+'%'}">{{failedIgnoredPercentage}}%</div>
                                }
                                @if (otherIgnored > 0) {
                                    <div [tooltip]="otherIgnoredPercentage+'% of ignored test cases are incomplete'" containerClass="ratioTooltip" class="ratio other" [class.start]="completedIgnored == 0 && failedIgnored == 0" [class.end]="true" [ngStyle]="{'width': otherIgnoredPercentage+'%'}">{{otherIgnoredPercentage}}%</div>
                                }
                            </div>
                        </div>
                    }
                </div>
                <div class="close-container" (click)="expanded = false" tooltip="Close" containerClass="shortTooltip"><span><i class="fa-solid fa-times"></i></span></div>
            </div>
        </div>
    }
</div>
